#update ids
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink  --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_clean --update-ids \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_clean_wei.fam --make-bed --out \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id
#makde new fam file
write.table(fam[,c(7:12)],'//10.141.0.2/Kadoorie/weigan/DATASETS//CKB_Clean_new_id.fam',row.names=F,col.names=F,quote=F)
#calculate freq and callrate
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink  --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id --missing --freq --out \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id
#extract t2d snps
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink  --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id --extract  \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d.snp.list --make-bed --out \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d
#flip strand
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink  --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d --flip  \\10.141.0.2\Kadoorie\weigan\DATASETS\flip.strand.list.snp --make-bed --out \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink  --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward --freq --out \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward.freq
#risk allele recoding
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink  --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward --recodeA --recode-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --out \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward_risk
#check callrate
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink  --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --missing --out \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward_risk_miss
#recode as raw data
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward --set-hh-missing --recodeA --recode-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --out  \\10.141.0.2\Kadoorie\weigan\T2D_GRS\allt2dsnp_total

#update sex info
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --noweb --bfile \\10.141.0.2\Kadoorie\weigan\DATASETS\CKB_Clean_new_id_t2d_forward --set-hh-missing --update-sex \\10.141.0.2\Kadoorie\weigan\T2D_GRS\updatesex_all.txt --keep \\10.141.0.2\Kadoorie\weigan\T2D_GRS\updatesex_all.txt --make-bed --out  \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex

#risk allele frequency 
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --freq --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\frequency
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --missing --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\missing
#recode as raw data
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --set-hh-missing --recodeA --recode-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --out  \\10.141.0.2\Kadoorie\weigan\T2D_GRS\allt2dsnp

#hwe
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --keep \\10.141.0.2\Kadoorie\weigan\DATASETS\unrelated.batch23.txt --snps rs10886471,rs7403531 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_2snp_batch23_hardy

#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 12 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region12
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 16 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region16
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 26 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region26
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 36 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region36
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 46 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region46
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 52 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region52
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 58 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region58
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 68 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region68
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 78 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region78
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_unrelated_t2d --hardy --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --keep-clusters \\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink_score\region.txt --keep-cluster-names 88 --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_hardy_region88

#Callrate
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --missing --extract \\10.141.0.2\Kadoorie\weigan\DATASETS\t2d_snp_in_bantch123_miss0.95.txt --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_52_batch123_callrate_region
#\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --missing --keep \\10.141.0.2\Kadoorie\weigan\DATASETS\unrelated.batch23.txt --snps rs10886471,rs7403531 --within \\10.141.0.2\Kadoorie\weigan\T2D_GRS\region.txt --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_2snp_batch23_callrate_region


#single snp association analysis
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --logistic --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --pheno-name diabetes --covar \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --sex --hide-covar --covar-name age,region --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\t2d_add
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --logistic --dominant --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --pheno-name diabetes --covar \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --sex --hide-covar --covar-name age,region --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\t2d_dom
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --logistic --recessive --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --pheno-name diabetes --covar \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --sex --hide-covar --covar-name age,region --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\t2d_rec

\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --logistic --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --pheno-name diabetes_cc --covar \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --sex --hide-covar --covar-name age,region --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\t2d_add_cc
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --logistic --dominant --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --pheno-name diabetes_cc --covar \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --sex --hide-covar --covar-name age,region --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\t2d_dom_cc
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --logistic --recessive --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --pheno-name diabetes_cc --covar \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_ass_phenotype.txt --sex --hide-covar --covar-name age,region --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\t2d_rec_cc

#T2D trAITS single snp associaiton 
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --linear --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\t2d_phenotype_baseline.txt --all-pheno --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\traits_add
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --linear --dominant --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\t2d_phenotype_baseline.txt --all-pheno --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\traits_dom
\\10.141.0.2\Kadoorie\weigan\T2D_GRS\plink --bfile \\10.141.0.2\Kadoorie\weigan\T2D_GRS\CKB_Clean_total_t2d_updatessex --linear --recessive --ci 0.95 --reference-allele \\10.141.0.2\Kadoorie\weigan\DATASETS\risk.allele.code --pheno \\10.141.0.2\Kadoorie\weigan\T2D_GRS\t2d_phenotype_baseline.txt --all-pheno --out \\10.141.0.2\Kadoorie\weigan\T2D_GRS\single_snp_association\traits_rec

